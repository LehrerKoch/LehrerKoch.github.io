<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

    <title>Biquadratische Gleichungen Übungsaufgaben</title>

    <link rel="stylesheet" type="text/css" href="styles.css">
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-5K8WYYXDL2"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-5K8WYYXDL2');
    </script>
    <script>
        function randomElement(array) {
            return array[Math.floor(Math.random() * array.length)];
        }

        function monomText(coefficient, exponent, printPlusSign = 1, printNull = 0, printKlammernBeiNegativen = 0, variable = 'x') {
            let coefficientText = '';
            if (coefficient === 0) {
                if (printNull === 1){
                    return '0';
                } else {
                    return '';
                }
            }
            if (coefficient === 1 && exponent > 0){
                coefficientText = '';
            } else if (coefficient === -1  && exponent > 0) {
                coefficientText = '-';
            } else {
                coefficientText = `${coefficient}`.replace('.',',');
            }
            let exponentText = '';
            if (exponent === 0) {
                exponentText = '';
            } else if (exponent === 1) {
                exponentText = variable;
            } else {
                exponentText = `${variable}^{${exponent}}`;
            }
            if (printKlammernBeiNegativen === 1 && coefficient < 0) {
                coefficientText = `(${coefficientText})`;
            }
            let plusSign = '';
            if (printPlusSign === 1 && coefficient > 0){
                plusSign = '+';
            }
            return `${plusSign} ${coefficientText}${exponentText}`;
        }

        function formatMathNumber(n) {
            if (typeof n === 'number') {
                if (Number.isInteger(n)) return `${n}`.replace('.',',');
                return `${n}`.replace('.',',');
            }
            return `${n}`;
        }

        function getParams() {
            const urlParams = new URLSearchParams(window.location.search);
            return {
                diff: urlParams.has('diff') ? parseInt(urlParams.get('diff')) : 1,
                as: urlParams.has('as') ? parseInt(urlParams.get('as')) : 3,
                auch0: urlParams.has('auch0') ? parseInt(urlParams.get('auch0')) : 1,
                auch2: urlParams.has('auch2') ? parseInt(urlParams.get('auch2')) : 1,
                auch4: urlParams.has('auch4') ? parseInt(urlParams.get('auch4')) : 1,
                auchDoppelt: urlParams.has('auchDoppelt') ? parseInt(urlParams.get('auchDoppelt')) : 0,
                nurSpez: urlParams.has('nurSpez') ? parseInt(urlParams.get('nurSpez')) : 0
            };
        }

        let A = 1;
        let b = 0;
        let c = 0;
        let chosenY1 = null;
        let chosenY2 = null;

        function generateRandomNumbers() {
const { diff, as, auch0, auch2, auch4 } = getParams();


// Menge der x-Werte
let xValues = diff === 0 ? [1, 2, 3, 4] : [1, 2, 3, 4, 5, 6];


// Auswahl für a
let possibleAValues = [];
if (as === 1) possibleAValues = [1];
else if (as === 2) possibleAValues = [1, 1, 2, 2, 3, 3, 4, 5];
else if (as === 3) possibleAValues = [-5,-4,-3,-2,-1,1,2,3,4,5];
else if (as === 4) possibleAValues = [-5,-4,-3,-2,-1,1,2,3,4,5];


A = randomElement(possibleAValues);


// gewünschte Anzahl Lösungen
const desiredCounts = [];
if (auch0 === 1) desiredCounts.push(0);
if (auch2 === 1) desiredCounts.push(2);
if (auch4 === 1) desiredCounts.push(4);
if (desiredCounts.length === 0) {
document.getElementById('formula').innerHTML = "$$\\text{Keine Einstellung für Nullstellen gewählt}$$";
document.getElementById('loesung').innerHTML = '';
document.getElementById('vorgehen').innerHTML = '';
MathJax.typeset();
return;
}


rootCase = randomElement(desiredCounts);
chosenX1 = randomElement(xValues);
chosenX3 = randomElement(xValues);

if (chosenX1 < chosenX3) {
    [chosenX1, chosenX3] = [chosenX3, chosenX1];
}



let polyB = 0;
let polyC = 0;


if (rootCase === 4) {
b = -A * (chosenX1 * chosenX1 + chosenX3 * chosenX3);
c = A * (chosenX1 * chosenX1 * chosenX3 * chosenX3);
} else if (rootCase === 2) {
// (x^2 - x1^2)(x^2 + x3^2)
b = A * (chosenX3 * chosenX3 - chosenX1 * chosenX1);
c = -A * (chosenX1 * chosenX1 * chosenX3 * chosenX3);
} else if (rootCase === 0) {
// (x^2 + x1^2)(x^2 + x3^2)
b = A * (chosenX1 * chosenX1 + chosenX3 * chosenX3);
c = A * (chosenX1 * chosenX1 * chosenX3 * chosenX3);
}


const formula = `0 = ${monomText(A,4,0)} ${monomText(b,2)} ${monomText(c,0)}`;


document.getElementById('formula').innerHTML = `$$${formula}$$`;
document.getElementById('loesung').innerHTML = '';
document.getElementById('vorgehen').innerHTML = '';
MathJax.typeset();
}

function loesung() {
    if (chosenX1 === null) {
        document.getElementById('loesung').innerHTML = "$$\\text{Keine Aufgabe generiert}$$";
        MathJax.typeset();
        return;
    }

    let out = '';
    if (rootCase === 0) {
        out = "$$\\text{Keine reellen Lösungen (n.l.)}$$";
    } else if (rootCase === 2) {
        out = `$$x_{1,2}=\\pm${chosenX1},\\qquad \\text{n.l. für }z_2$$`;
    } else if (rootCase === 4) {
        out = `$$x_{1,2}=\\pm${chosenX1},\\qquad x_{3,4}=\\pm${chosenX3}$$`;
    }

    document.getElementById('loesung').innerHTML = out;
    MathJax.typeset();
}


function formatSignedNumber(n) {
    if (typeof n === 'number') {
        const str = Number.isInteger(n) ? n.toString() : n.toString();
        return (n >= 0 ? '+' : '') + str.replace('.', ',');
    }
    return n.toString();
}


function hilfe() {
    if (chosenX1 === null) {
        document.getElementById('vorgehen').innerHTML = '<p>Keine Aufgabe generiert. Klicke zuerst auf "Neue Aufgabe generieren".</p>';
        return;
    }

    let html = '';
    html += `<p>Bringe zunächst alle Terme auf eine Seite der Gleichung und fasse zusammen, sodass die andere Seite der Gleichung\\(~=0\\) ergibt).<br>Das ist hier schon der Fall:</p>`;
    html += `<p>$$${monomText(A,4,0)} ${monomText(b,2)} ${monomText(c,0)}=0$$</p>`;

    html += `<p>Wir erkennen, dass alle Exponenten Vielfache von 2 sind (nur gerade Exponenten vorhanden):</p>`;
    html += `$$${monomText(A,4,0).replace(/\\^\\{(\\d+)\\}/g,'^{\\\\textcolor{green}{$1}}')} ${monomText(b,2).replace(/\\^\\{(\\d+)\\}/g,'^{\\\\textcolor{green}{$1}}')} ${monomText(c,0)}=0$$`;

    html += `<p>d.h. es handelt sich wirklich um eine biquadratische Gleichung.</p>`;
    html += `<p>Wir substituieren \\(z=x^2\\):</p>`;
    html += `$$${monomText(A,2,0,0,0,'z')} ${monomText(b,1,1,0,0,'z')} ${monomText(c,0,1,1,0,'z')}=0$$`;

    if (A !== 1) {
        html += `<p>Da ein \\(a\\) vorhanden (\\(a=${formatMathNumber(A)} \\neq 1\\)), teilen wir die Gleichung durch \\(a=${formatMathNumber(A)}\\):</p>`;
    } else {
        html += `<p>Da \\(a=1\\), können wir direkt die p-q-Formel anwenden:</p>`;
    }

    const p = b/A;
    const q = c/A;

    // Quadratische Normalform
    html += `$$z^2 ${formatSignedNumber(p)}z + ${formatMathNumber(q)}=0$$`;
    html += `$$p=${formatSignedNumber(p)},\\qquad q=${formatSignedNumber(q)}$$`;

    // p-q-Formel
    html += `<p>Anwenden der p-q-Formel:</p>`;
    html += `$$z_{1,2} = -\\tfrac{p}{2} \\pm \\sqrt{\\left(\\tfrac{p}{2}\\right)^2 - q}$$`;

    // Einsetzen
    html += `<p>Einsetzen von p und q:</p>`;
    html += `$$z_{1,2} = -\\left(\\tfrac{${formatMathNumber(p)}}{2}\\right) \\pm \\sqrt{\\left(\\tfrac{${formatMathNumber(p)}}{2}\\right)^2 - (${formatMathNumber(q)})}$$`;

    const ph = -p/2
    const D = p*p/4 - q;
    const z1 = -p/2 + Math.sqrt(D);
    const z2 = -p/2 - Math.sqrt(D);

    html += `$$= ${ph} \\pm \\sqrt{${D}}$$`;
    // Ergebnisse
    html += `<p>Also:</p>`;
    html += `$$z_1=${formatMathNumber(z1)},\\qquad z_2=${formatMathNumber(z2)}$$`;

    // Resubstitution in Tabelle
    html += `<p>Resubstituiere \\(z=x^2\\):</p>`;
    html += `\\[\\begin{array}{rcl}
    z_1=${formatMathNumber(z1)} &\\Rightarrow& x^2=${formatMathNumber(z1)} \\\\
     & & ${z1 >= 0 ? `x_{1,2}=\\pm\\sqrt{${formatMathNumber(z1)}}` : `\\text{keine reellen Lösungen}`} \\\\[6pt]
    z_2=${formatMathNumber(z2)} &\\Rightarrow& x^2=${formatMathNumber(z2)} \\\\
     & & ${z2 >= 0 ? `x_{3,4}=\\pm\\sqrt{${formatMathNumber(z2)}}` : `\\text{keine reellen Lösungen}`}
    \\end{array}\\]`;

    document.getElementById('vorgehen').innerHTML = html;
    MathJax.typeset();
}


        window.onload = generateRandomNumbers;

    </script>

</head>

<body>
    <h1>Biquadratische Gleichungen Übungsaufgaben</h1>

    <details>
        <summary>Settings</summary>
        <form id="radioForm" action="" method="get">
          <div class="form-block">
            <label for="diff"><b>Schwierigkeit (z=x^2):</b></label><br>
            <input type="radio" id="diff1" name="diff" value="0"> Einfach<br>
            <input type="radio" id="diff2" name="diff" value="1" checked> Normal<br>
            <input type="radio" id="diff3" name="diff" value="2"> Schwierig<br>
          </div>
          <div class="form-block">
            <label for="mitA"><b>Mit Streckfaktor A:</b></label><br>
            <input type="radio" id="a1" name="as" value="1"> Immer 1<br>
            <input type="radio" id="a2" name="as" value="2"> Einfach<br>
            <input type="radio" id="a3" name="as" value="3" checked> Auch negativ<br>
            <input type="radio" id="a4" name="as" value="4"> Beliebig<br>
          </div>
          <div class="form-block">
            <b>Anzahl reeller Nullstellen:</b><br>
            <input type="checkbox" id="auch0" name="auch0" value="1" checked>0<br>
            <input type="checkbox" id="auch2" name="auch2" value="1" checked>2<br>
            <input type="checkbox" id="auch4" name="auch4" value="1" checked>4<br>
          </div>
          <div class="form-block">
            <b>Spezialfälle</b><br>
            <input type="checkbox" id="nurSpez" name="nurSpez" value="1"> Nur Spezialfälle<br>
            <input type="checkbox" id="auchDoppelt" name="auchDoppelt" value="1"> Auch doppelte y-Wurzeln<br>
          </div>
        </form>
    </details>

    <p><button onclick="generateRandomNumbers()">Neue Aufgabe generieren</button></p>
    <p>Löse die biquadratische Gleichung:</p>
    <p><span id="formula"></span></p>

    <button onclick="loesung()">Lösung (kurz) anzeigen</button>
    <p><span id="loesung"></span></p>

    <button onclick="hilfe()">Hilfe / vollständiger Lösungsweg anzeigen</button>
    <div id="vorgehen"></div>

</body>
</html>
